[
  {
    "id": "392dgzr1sp5jjey",
    "name": "users",
    "type": "auth",
    "system": false,
    "schema": [
      {
        "system": false,
        "id": "id1nb8qm",
        "name": "displayName",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "system": false,
        "id": "dco46y8c",
        "name": "pubKey",
        "type": "text",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      }
    ],
    "indexes": [],
    "listRule": "@request.auth.id != \"\"",
    "viewRule": "@request.auth.id != \"\"",
    "createRule": "",
    "updateRule": "id = @request.auth.id",
    "deleteRule": "id = @request.auth.id",
    "options": {
      "allowEmailAuth": true,
      "allowOAuth2Auth": false,
      "allowUsernameAuth": true,
      "exceptEmailDomains": null,
      "manageRule": null,
      "minPasswordLength": 8,
      "onlyEmailDomains": null,
      "onlyVerified": false,
      "requireEmail": false
    }
  },
  {
    "id": "n9jpi61x3w8cgrb",
    "name": "chat_participants",
    "type": "base",
    "system": false,
    "schema": [
      {
        "system": false,
        "id": "sisz5qrp",
        "name": "room",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "1rtd5cucnemzuh6",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "sckjdofr",
        "name": "user",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "8zrt5xfv",
        "name": "encRoomKey",
        "type": "json",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSize": 2000000
        }
      }
    ],
    "indexes": [
      "CREATE INDEX `uq_room_user` ON `chat_participants` (\n  `room`,\n  `user`\n)",
      "CREATE INDEX `idx_user` ON `chat_participants` (`user`)"
    ],
    "listRule": "@request.auth.id != \"\" && (\n  user.id = @request.auth.id || room.createdBy.id = @request.auth.id\n)",
    "viewRule": "@request.auth.id != \"\" && (\n  user.id = @request.auth.id || room.createdBy.id = @request.auth.id\n)",
    "createRule": "@request.auth.id != \"\" && (\n  room.createdBy.id = @request.auth.id || user.id = @request.auth.id\n)",
    "updateRule": "user.id = @request.auth.id",
    "deleteRule": "user.id = @request.auth.id || room.createdBy.id = @request.auth.id",
    "options": {}
  },
  {
    "id": "1rtd5cucnemzuh6",
    "name": "chat_rooms",
    "type": "base",
    "system": false,
    "schema": [
      {
        "system": false,
        "id": "k7xhlzyu",
        "name": "type",
        "type": "select",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "maxSelect": 1,
          "values": [
            "direct",
            "group"
          ]
        }
      },
      {
        "system": false,
        "id": "c8q3ymt8",
        "name": "createdBy",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "fiopxxcq",
        "name": "pairKey",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "system": false,
        "id": "mrotgwbz",
        "name": "aId",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "fqeg7qqi",
        "name": "bId",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      }
    ],
    "indexes": [
      "CREATE INDEX `idx_rooms_createdby` ON `chat_rooms` (`createdBy`)",
      "CREATE UNIQUE INDEX `idx_rooms_pairKey` ON `chat_rooms` (`pairKey`)"
    ],
    "listRule": "@request.auth.id != \"\" && (\n  aId.id = @request.auth.id || bId.id = @request.auth.id\n)\n",
    "viewRule": "@request.auth.id != \"\" && (\n  aId.id = @request.auth.id || bId.id = @request.auth.id\n)",
    "createRule": "@request.auth.id != \"\" && (\n  aId.id = @request.auth.id || bId.id = @request.auth.id\n)\n",
    "updateRule": "createdBy.id = @request.auth.id",
    "deleteRule": "createdBy.id = @request.auth.id",
    "options": {}
  },
  {
    "id": "oi5o0nkgv96221u",
    "name": "device_tokens",
    "type": "base",
    "system": false,
    "schema": [
      {
        "system": false,
        "id": "rzurrrj4",
        "name": "user",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "nqbdfayd",
        "name": "token",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      }
    ],
    "indexes": [
      "CREATE INDEX `uq_tokens_user_token` ON `device_tokens` (\n  `user`,\n  `token`\n)"
    ],
    "listRule": "@request.auth.id = user.id",
    "viewRule": "@request.auth.id = user.id",
    "createRule": "@request.auth.id = user.id",
    "updateRule": "@request.auth.id = user.id",
    "deleteRule": "@request.auth.id = user.id",
    "options": {}
  },
  {
    "id": "fvmwwe3gymb3lpl",
    "name": "messages",
    "type": "base",
    "system": false,
    "schema": [
      {
        "system": false,
        "id": "uajgimbn",
        "name": "room",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "1rtd5cucnemzuh6",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "kjdbktmb",
        "name": "sender",
        "type": "relation",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "collectionId": "392dgzr1sp5jjey",
          "cascadeDelete": false,
          "minSelect": null,
          "maxSelect": 1,
          "displayFields": null
        }
      },
      {
        "system": false,
        "id": "57xyjzgv",
        "name": "ciphertext",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "system": false,
        "id": "4c8cbfo9",
        "name": "nonce",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": ""
        }
      },
      {
        "system": false,
        "id": "vxml9ljh",
        "name": "algo",
        "type": "text",
        "required": true,
        "presentable": false,
        "unique": false,
        "options": {
          "min": null,
          "max": null,
          "pattern": "^[a-z0-9_-]+$"
        }
      },
      {
        "system": false,
        "id": "e7nmx7i6",
        "name": "attachment",
        "type": "file",
        "required": false,
        "presentable": false,
        "unique": false,
        "options": {
          "mimeTypes": [],
          "thumbs": [],
          "maxSelect": 1,
          "maxSize": 10485760,
          "protected": false
        }
      }
    ],
    "indexes": [
      "CREATE INDEX `idx_messages_room_created` ON `messages` (\n  `room`,\n  `created`\n)"
    ],
    "listRule": "@request.auth.id != \"\" && (\n  room.aId.id = @request.auth.id || room.bId.id = @request.auth.id\n)",
    "viewRule": "@request.auth.id != \"\" && (\n  room.aId.id = @request.auth.id || room.bId.id = @request.auth.id\n)",
    "createRule": "@request.auth.id != \"\" && sender.id = @request.auth.id && (\n  room.aId.id = @request.auth.id || room.bId.id = @request.auth.id\n)",
    "updateRule": "sender.id = @request.auth.id",
    "deleteRule": "sender.id = @request.auth.id",
    "options": {}
  }
]